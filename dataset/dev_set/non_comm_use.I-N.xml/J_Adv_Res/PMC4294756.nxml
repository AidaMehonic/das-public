<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">J Adv Res</journal-id><journal-id journal-id-type="iso-abbrev">J Adv Res</journal-id><journal-title-group><journal-title>Journal of Advanced Research</journal-title></journal-title-group><issn pub-type="ppub">2090-1232</issn><issn pub-type="epub">2090-1224</issn><publisher><publisher-name>Elsevier</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">25685512</article-id><article-id pub-id-type="pmc">4294756</article-id><article-id pub-id-type="publisher-id">S2090-1232(13)00141-0</article-id><article-id pub-id-type="doi">10.1016/j.jare.2013.11.005</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Article</subject></subj-group></article-categories><title-group><article-title>An efficient method to detect periodic behavior in botnet traffic by analyzing control plane traffic</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>AsSadhan</surname><given-names>Basil</given-names></name><email>bsadhan@ksu.edu.sa</email><xref rid="af005" ref-type="aff">a</xref><xref rid="cor1" ref-type="corresp">&#x0204e;</xref></contrib><contrib contrib-type="author"><name><surname>Moura</surname><given-names>Jos&#x000e9; M.F.</given-names></name><xref rid="af010" ref-type="aff">b</xref></contrib></contrib-group><aff id="af005"><label>a</label>Department of Electrical Engineering, King Saud University, P.O. Box 800, Riyadh 11421, Saudi Arabia</aff><aff id="af010"><label>b</label>Department of Electrical and Computer Engineering, Carnegie Mellon University, Pittsburgh, PA, USA</aff><author-notes><corresp id="cor1"><label>&#x0204e;</label>Corresponding author. Tel.: +966 114676755; fax: +966 114676757. <email>bsadhan@ksu.edu.sa</email></corresp></author-notes><pub-date pub-type="pmc-release"><day>27</day><month>11</month><year>2013</year></pub-date><!-- PMC Release delay is 0 months and 0 days and was based on <pub-date
						pub-type="epub">.--><pub-date pub-type="ppub"><month>7</month><year>2014</year></pub-date><pub-date pub-type="epub"><day>27</day><month>11</month><year>2013</year></pub-date><volume>5</volume><issue>4</issue><fpage>435</fpage><lpage>448</lpage><history><date date-type="received"><day>20</day><month>9</month><year>2013</year></date><date date-type="rev-recd"><day>17</day><month>11</month><year>2013</year></date><date date-type="accepted"><day>21</day><month>11</month><year>2013</year></date></history><permissions><copyright-statement>&#x000a9; 2013 Production and hosting by Elsevier B.V.</copyright-statement><copyright-year>2013</copyright-year><copyright-holder/><license license-type="CC BY-NC-ND" xlink:href="http://creativecommons.org/licenses/by-nc-nd/3.0/"><license-p>This is an open access article under the CC BY-NC-ND license (http://creativecommons.org/licenses/by-nc-nd/3.0/).</license-p></license></permissions><abstract><p>Botnets are large networks of bots (compromised machines) that are under the control of a small number of bot masters. They pose a significant threat to Internet&#x02019;s communications and applications. A botnet relies on command and control (C2) communications channels traffic between its members for its attack execution. C2 traffic occurs prior to any attack; hence, the detection of botnet&#x02019;s C2 traffic enables the detection of members of the botnet before any real harm happens. We analyze C2 traffic and find that it exhibits a periodic behavior. This is due to the pre-programmed behavior of bots that check for updates to download them every <italic>T</italic> seconds. We exploit this periodic behavior to detect C2 traffic. The detection involves evaluating the periodogram of the monitored traffic. Then applying Walker&#x02019;s large sample test to the periodogram&#x02019;s maximum ordinate in order to determine if it is due to a periodic component or not. If the periodogram of the monitored traffic contains a periodic component, then it is highly likely that it is due to a bot&#x02019;s C2 traffic. The test looks only at aggregate <italic>control plane</italic> traffic behavior, which makes it more scalable than techniques that involve deep packet inspection (DPI) or tracking the communication flows of different hosts. We apply the test to two types of botnet, tinyP2P and IRC that are generated by SLINGbot. We verify the periodic behavior of their C2 traffic and compare it to the results we get on real traffic that is obtained from a secured enterprise network. We further study the characteristics of the test in the presence of injected HTTP background traffic and the effect of the duty cycle on the periodic behavior.</p></abstract><kwd-group><title>Keywords</title><kwd>Botnet detection</kwd><kwd>Control plane traffic</kwd><kwd>Discrete time series analysis</kwd><kwd>Walker large sample test</kwd><kwd>SLINGbot</kwd></kwd-group></article-meta></front><body><sec sec-type="intro" id="s0005"><title>Introduction</title><p>Botnets are large networks of bots (compromised machines) that are under the control of a small number of bot masters. In recent years, the threat posed by botnets toward Internet applications and communications has escalated. This is due to the fact that a bot master controls a large number of bots that ranges from hundreds of thousands to millions. This magnifies the impact of well-known network malicious activities such as scanning, E-mail spam and distributed denial-of-service (DDoS) attacks. Moreover, botnets increase the effectiveness of phishing, click fraud, identity theft, and espionage.</p><p>Due to the destructive capabilities of botnets, they have become a major threat to economy, information, and communication infrastructures. The Federal Bureau of Investigation (FBI) in the United States, in an initiative to detect bot masters and take them apart has identified over 1 million victim computers <xref rid="b0005 b0010" ref-type="bibr">[1,2]</xref>. Many people have been indicted, pleaded guilty, or been sentenced for crimes related to botnet usage <xref rid="b0005 b0010" ref-type="bibr">[1,2]</xref>. What increases the impact of the problem is that the majority of the owners of the compromised machines are not aware that their machines are a member of a botnet <xref rid="b0005" ref-type="bibr">[1]</xref>. According to the April 2013 Symantec Internet Security Threat Report, Volume 18, 3.4 million distinct bot-infected computers were observed in 2012 <xref rid="b0015" ref-type="bibr">[3]</xref>. According to the same report, botnets were responsible for about 69% of spam E-mail in 2012 <xref rid="b0015" ref-type="bibr">[3]</xref>. The good news; there is a decrease in these numbers over the past years. For example, in 2009, there were 6.08 million distinct bot-infected computers and botnets were responsible for about 85% of spam E-mail <xref rid="b0020" ref-type="bibr">[4]</xref>. Nevertheless, the numbers are still high; moreover, bot masters have begun linking mobile smart phones to form botnets of mobile devices to make monetary profits <xref rid="b0015" ref-type="bibr">[3]</xref>.</p><p>Botnets&#x02019; traffic is different from the traffic of other types of malware in that it includes command and control (C2) communication channels traffic. A bot master relies on these channels to send commands to the members of its botnet to execute attack activities. In addition, a bot master relies on these channels to control botnet members to obtain the needed information and code to run their attacks. C2 communication channels traffic occurs before the execution of attack activities and can be considered as the intelligence communication between the different members of a botnet. This makes the detection of C2 communication channels traffic of interest as it means detecting bots before any targeted victim is attacked.</p><p>The detection of C2 traffic is difficult due to several reasons that was pointed out by AsSadhan et. al <xref rid="b0025" ref-type="bibr">[5]</xref>. They include the following: (1) the low volume of C2 traffic; (2) C2&#x02019;s traffic is well behaved and does not violate any network protocol rules; (3) there may be only a few number of botnet members in the monitored network; and (4) the C2 traffic might be encrypted <xref rid="b0025" ref-type="bibr">[5]</xref>. To tackle these difficulties, we look at one behavior that we, along with other researchers, observed in C2 traffic <xref rid="b0025 b0030 b0035" ref-type="bibr">[5&#x02013;7]</xref>. The behavior we observe is spatial-temporal correlation and similarities in the C2 communication traffic of the bots belonging to the same botnet.</p><p>In our work, we focus on temporal correlation in a single bot&#x02019;s traffic. We find that a bot&#x02019;s C2 traffic exhibits periodic behavior. This is due to the nature of the pre-programmed behavior of a bot, where in many variations of botnets each bot frequently contacts other bots every <italic>T</italic> seconds. This pre-programmed behavior is present in botnets with different structures and communication protocols and is done in order for bots to update their data, receive commands, and send keep-alive messages. We note that the periodic behavior is observed when looking at the traffic of the transport port number used by the bot for its C2 communication.</p><p>As a result, the detection of periodic behavior in a machine&#x02019;s traffic might be an indication that the machine is a member of a botnet. We exploit this observation in order to detect bots by detecting periodic behavior in the traffic of the network we monitor. To achieve this we present in this paper an efficient method to detect periodic behavior in botnet command and control traffic. The method is based on the evaluation of the traffic sequence&#x02019;s periodogram. A periodogram is used to view a periodic signal in the frequency domain to observe the peak located at the fundamental frequency of the signal. After the peak is located, we apply Walker&#x02019;s large sample test to decide whether or not the peak is significant enough compared to the rest of the periodogram&#x02019;s ordinates. In case the peak is significant, we declare that it is due to a periodic component with the frequency where the peak is located.</p><p>To increase the efficiency of the method further, we decompose enterprise LAN TCP traffic into control and data planes <xref rid="b0040" ref-type="bibr">[8]</xref>, and use the control plane traffic as a surrogate for the whole traffic (control and data planes combined). This is because data traffic generation is based on control traffic generation, which makes the behavior of the two traffic groups similar <xref rid="b0040" ref-type="bibr">[8]</xref>.</p><p>The rest of the paper is organized as follows, Section &#x0201c;Background and motivation: Detection of periodic behavior in botnet C2 communication channels traffic&#x0201d; reviews the command and control (C2) traffic of botnets and proposes how to detect botnets. Section &#x0201c;Approach: Discrete time series analysis of aggregate traffic&#x0201d; explains how we aggregate network traffic and decompose them into control and data planes traffic. Section &#x0201c;Methodology: Test network traffic for periodic behavior using periodograms&#x0201d; reviews periodograms and presents the Walker&#x02019;s large sample test. Section &#x0201c;Experimental setup: Evaluation and analysis&#x0201d; explains the experimental setup and presents our evaluation and analysis results of applying the test to several packets traces, and in Section &#x0201c;Conclusions&#x0201d; we give our conclusions.</p></sec><sec id="s0010"><title>Background and motivation: Detection of periodic behavior in botnet C2 communication channels traffic</title><p>Since a bot master controls a botnet via command and control (C2) communication channels. Our approach is to detect a botnet through the detection of its C2 communication channels traffic. This technique is effective as it detects bots before they engage in harmful malicious activities. This is because C2 traffic by itself is harmless, and its detection it will enable the detection of the bots that are transmitting/receiving it.</p><p>The C2 communication channels between bots and the C2 servers are based on either a pull or push mechanism <xref rid="b0035" ref-type="bibr">[7]</xref>. Depending on the mechanism used, bots are pre-programmed to contact each other every <italic>T</italic> seconds to update bot&#x02019;s data, receive commands, and send <italic>keep-alive</italic> messages. This pattern of behavior is present in bots irrespective of the botnet&#x02019;s structure or the communication protocol being used between bots and the C2 server. This results in having a <italic>periodic</italic> behavior in the bot&#x02019;s traffic over a given transport port number. We note that in other botnet variants, C2 communication happens might occur in an aperiodic manner at arbitrary times. We briefly discuss this issue in Section &#x0201c;Experimental setup: Evaluation and analysis&#x0201d;.</p><p>In our work, we exploit this periodic behavior to detect C2 communication traffic. In addition to our previous works <xref rid="b0025 b0030" ref-type="bibr">[5,6]</xref>, we are aware of a previous study, that exploits the periodic behavior of botnet C2 traffic to detect bots. In Gu et al. <xref rid="b0035" ref-type="bibr">[7]</xref>, the host&#x02019;s traffic autocorrelation function was computed in the time domain to examine whether the traffic has a periodic component or not. We, however, work in the frequency domain, as it involves less amount of computations, thus is faster in time. This is done thorough evaluating the periodogram <xref rid="b0045" ref-type="bibr">[9]</xref> of the traffic and then applying Walker&#x02019;s large sample test <xref rid="b0050" ref-type="bibr">[10]</xref> to the periodogram&#x02019;s maximum ordinate to detect periodic components.</p><p>The advantage of such technique is that it is based on an basic property shared by many botnet variants and is independent of the structure (e.g., centralized, P2P) and communication protocol (e.g., IRC, HTTP) used in the botnet. What is important is that it does not require a priori knowledge (e.g., signatures) of a certain botnet behavior, provided the C2 communication traffic exhibits periodic behavior. We note that network traffic in general can exhibit periodic behavior. Example of this would be an E-mail session that checks periodically for new messages. This can affect the accuracy of the detection of C2 traffic by introducing false positives. We address this issue in Section &#x0201c;Experimental setup: Evaluation and analysis&#x0201d;.</p></sec><sec id="s0015"><title>Approach: Discrete time series analysis of aggregate traffic</title><p>To detect botnet C2 communication channels traffic, we apply discrete time series analysis to study the aggregate traffic behavior. To accomplish this, we have to extract a discrete time sequence from a packet trace. This is done by first aggregating packets originating from or destined to a given host, subnet, or network over an appropriate aggregation interval. Next, we extract a count-feature <xref rid="b0040 b0055" ref-type="bibr">[8,11]</xref> from the packet header information to produce the discrete time sequence. The basic count feature is the packet count, which is the number of packets in that aggregation interval. Other examples of count-features include the byte count, which is the total number of bytes in all of the packets within the aggregation interval, and the different addresses count, which is the total number of distinct IP addresses in all of the packets within the aggregation interval. The selection of the aggregation interval is based on the packet rate of the traffic at the given host, subnet, or network. A higher packet rate implies using a smaller the aggregation interval. The objective is to avoid a discrete time sequence with low variance.</p><p>Having packet traces in the form of discrete time sequences enables applying statistical signal processing methods that are used in discrete time series analysis. Furthermore, monitoring aggregate traffic behavior requires keeping track of less details of the traffic when compared for example to tracking the communication flows of different hosts or examining the content of individual packets. We acknowledge that tracking less details of network traffic implies having less knowledge, which might lead to a lower accuracy in detection and higher false positive rates, but has several advantages. First, it consumes less computational processing, hence faster analysis in time; both contributing to higher scalability. We emphasize that with the larger growth in using high bit rate applications in the Internet, the demand for higher scalability has increased. Second, characterizing malicious activities traffic with less details can lead to a detection scheme that is more resistant to evasion. This is because the malicious attacker will have more restrictions to evade the characterized malicious activity without compromising the efficiency of the attack.</p><sec id="s0020"><title>Discrete time series analysis of control plane traffic</title><p>The above analysis can be also applied to the <italic>control plane</italic> traffic packets <xref rid="b0040" ref-type="bibr">[8]</xref>. Control plane traffic packets as AsSadhan et. al define <xref rid="b0040" ref-type="bibr">[8]</xref> are the packets &#x0201c;that set, maintain, or tear down a connection&#x0201d;. Data plane traffic packets are those packets that are involved in the transmission of the actual data. For TCP packets, we treat a packet as a control plane packet if it is one of these four types:<list list-type="simple"><list-item id="o0005"><label>(1)</label><p>SYN packet.</p></list-item><list-item id="o0010"><label>(2)</label><p>Bare ACK packet, which is an acknowledgment packet with no payload.</p></list-item><list-item id="o0015"><label>(3)</label><p>FIN packet.</p></list-item><list-item id="o0020"><label>(4)</label><p>RST packet.</p></list-item></list></p><p>We apply discrete time series analysis to TCP <italic>control</italic> plane traffic due to its similar behavior to the data plane traffic as discussed previously <xref rid="b0040" ref-type="bibr">[8]</xref>. The reason behind this similarity is that the generation of data traffic is based on the generation of the control traffic <xref rid="b0040" ref-type="bibr">[8]</xref>. Therefore, analyzing the control plane traffic only we might suffices for analyzing the whole traffic (i.e., control and data planes). Such analysis reduces the amount of traffic to look at, which further implies fewer computations and faster analysis, both contributing to higher scalability. We note that since UDP is a connectionless unreliable protocol, the information in a packet&#x02019;s UDP header is not sufficient to decide whether to treat it as a control or data plane packet. Thus, unless we have access to the packet&#x02019;s application header and this header has sufficient information, it is not possible to decompose UDP packets into control and data planes packets as in the case of TCP.</p></sec></sec><sec id="s0025"><title>Methodology: Test network traffic for periodic behavior using periodograms</title><p>We propose to detect periodic behavior in botnet C2 traffic by analyzing the Power Spectral Density (PSD) of the network traffic. The PSD can be estimated by taking the Fourier transform of the autocorrelation function. Alternatively, a PSD can be estimated using periodograms <xref rid="b0045" ref-type="bibr">[9]</xref>. The periodogram of a time sequence (signal) provides its power at different frequencies. Periodograms have been used in other areas to detect periodic behavior like in biology <xref rid="b0060" ref-type="bibr">[12]</xref> and geophysics <xref rid="b0065" ref-type="bibr">[13]</xref>. It has also been used to analyze network traffic, see for example <xref rid="b0070" ref-type="bibr">[14]</xref>.</p><p>The periodogram is useful to identify frequency components that possess high power levels. Therefore, the periodogram of a periodic signal will have a high peak at the reciprocal of the fundamental period of the signal when compared to the mean of the periodogram. To evaluate the periodogram of a given traffic trace, we first extract a count-feature over a selected aggregation interval to produce a discrete time sequence <italic>x</italic>[<italic>n</italic>]. The periodogram <inline-formula><mml:math id="M1" altimg="si1.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> of a discrete time sequence <italic>x</italic>[<italic>n</italic>] is the square magnitude of the Discrete Fourier Transform (DFT) of the signal evaluated by <disp-formula id="e0005"><mml:math id="M2" altimg="si2.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="false">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mtext>,</mml:mtext></mml:math></disp-formula>where<disp-formula id="e0010"><mml:math id="M3" altimg="si3.gif" overflow="scroll"><mml:mi>X</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:mi>x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mrow><mml:mfenced open="(" close=")"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="italic">kn</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:math></disp-formula>is the <italic>N</italic>-point DFT.</p><p><xref rid="f0005" ref-type="fig">Fig. 1</xref> illustrates how periodograms can be used to detect periodic behavior. The top-left plot shows a periodic train of rectangular pulses with levels 0 and 1, a period of 0.1&#x000a0;s, a duty cycle of 20%, and a duration of 1&#x000a0;s. The one sided periodogram of this periodic signal after subtracting its mean is shown in the figure&#x02019;s bottom-left plot. The periodogram consists of a large peak at 10&#x000a0;<italic>Hz</italic>, smaller peaks at multiples of 10&#x000a0;<italic>Hz</italic>, which represent the harmonic components, and almost zero elsewhere. The figure&#x02019;s top-right plot shows an aperiodic Poisson random signal with a variance of 0.16, and a duration of 1&#x000a0;s. The selection of the variance was made in order to have it equal to the variance of the square wave signal. The one sided periodogram of the aperiodic signal after subtracting its mean is shown in the figure&#x02019;s bottom-right plot. It consists of several peaks; none of them has a significantly large value when compared to the mean of the periodogram.</p><p>The periodogram we described above is referred to as the standard periodogram. We note that we choose not to use the Welch&#x02019;s method of averaged periodogram <xref rid="b0045 b0075" ref-type="bibr">[9,15]</xref>. This is because our work is interested in the detection and estimation of a single periodic component, which is better achieved using the standard periodogram as discussed in So et al. <xref rid="b0080" ref-type="bibr">[16]</xref>. The averaged periodogram is used by others to represent the spectral density of the traffic <xref rid="b0070" ref-type="bibr">[14]</xref> and to detect a periodic component with non-stationary phase <xref rid="b0080" ref-type="bibr">[16]</xref>. We use however the modified periodogram <xref rid="b0045" ref-type="bibr">[9]</xref>. The modification is done by multiplying the traffic sequence by a Hamming window in order to reduce the level of the side-lobes. We note that windowing comes at the cost of reducing the sharpness of the peak.</p><sec id="s0030"><title>Detecting the significance of the periodogram&#x02019;s peak</title><p>From <xref rid="f0005" ref-type="fig">Fig. 1</xref>&#x02019;s bottom plots, we can see that the periodogram of any signal whether it is periodic or aperiodic will always have a peak. Thus, we need to have the ability to decide whether the peak is significant enough when compared to the rest of the periodogram&#x02019;s ordinates to declare that the sequence contains a periodic component or not. We use binary hypothesis testing <xref rid="b0085 b0090" ref-type="bibr">[17,18]</xref> to achieve this.</p><p>Before setting up the two hypotheses test, we state a basic assumption we adopt; the count-feature sequence extracted from the network traffic communication of a given host on a given port has a Poisson distribution. We acknowledge that Poisson statistics may or may not be an accurate model for network traffic at a given host on a given port. We use it to simplify the analysis. Other exponential family models will affect the threshold selection, but not the test itself.</p><p>The Poisson distribution is a good approximation to the binomial distribution when the binomial parameter <italic>n</italic> is large and the binomial parameter <italic>p</italic> is small<xref rid="fn1" ref-type="fn">1</xref>
<xref rid="b0095" ref-type="bibr">[19]</xref>. A binomial random variable with a large <italic>n</italic> and its Poisson approximation (when <italic>p</italic> is small) can be, based on the central limit theorem, approximated by a Gaussian random variable <xref rid="b0095" ref-type="bibr">[19]</xref>. Therefore, the count-feature sequence extracted from the packet trace after subtracting its mean and normalizing it by its standard deviation, can be treated as a standard Gaussian distribution (i.e., <italic>N</italic> (0,&#x000a0;1)).</p><p>We now set up the null hypothesis <italic>H</italic><sub>0</sub>; the count-feature sequence <italic>x</italic>[<italic>n</italic>] is Gaussian, against the alternative hypothesis <italic>H</italic><sub>1</sub>; <italic>x</italic>[<italic>n</italic>] has a periodic component at some unspecified frequency plus Gaussian noise. Under <italic>H</italic><sub>0</sub>, it can be shown that the ordinates <italic>P<sub>xx</sub></italic>[<italic>k</italic><sub>0</sub>] of the periodogram of <italic>x</italic>[<italic>n</italic>] are independent identically distributed (i.i.d.) <xref rid="b0050" ref-type="bibr">[10]</xref>. Each <italic>P<sub>xx</sub></italic>[<italic>k</italic><sub>0</sub>] has a distribution that is proportional to a chi-square distribution with two degrees of freedom <xref rid="b0050" ref-type="bibr">[10]</xref>. Specifically,<disp-formula id="e0015"><mml:math id="M4" altimg="si4.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c7;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mtext>.</mml:mtext></mml:math></disp-formula>Since a chi-square distribution with two degrees of freedom is equivalent to an exponential distribution with mean 2, it follows that the probability density function of <inline-formula><mml:math id="M5" altimg="si5.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is<disp-formula id="e0020"><mml:math id="M6" altimg="si6.gif" overflow="scroll"><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>,</mml:mtext><mml:mspace width="1em"/><mml:mn>0</mml:mn><mml:mi>&#x02264;</mml:mi><mml:mi>x</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:math></disp-formula>Therefore, for <italic>z</italic>&#x000a0;&#x02a7e;&#x000a0;0,<disp-formula id="e0035"><label>(1)</label><mml:math id="M7" altimg="si7.gif" overflow="scroll"><mml:mi mathvariant="normal">Pr</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>&#x02264;</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="italic">dx</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>.</mml:mtext></mml:math></disp-formula></p><p>Since we are interested in the periodogram&#x02019;s ordinate that has the maximum value, we define the ratio test statistics,<disp-formula id="e0040"><label>(2)</label><mml:math id="M8" altimg="si8.gif" overflow="scroll"><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>&#x02264;</mml:mi><mml:mi>k</mml:mi><mml:mi>&#x02264;</mml:mi><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:math></disp-formula>Since under <italic>H</italic><sub>0</sub>, the periodogram ordinates <italic>P<sub>xx</sub></italic>[<italic>k</italic><sub>0</sub>] are i.i.d., then it follows that, for <italic>z</italic>&#x000a0;&#x02a7e;&#x000a0;0,<disp-formula id="e0045"><label>(3)</label><mml:math id="M9" altimg="si9.gif" overflow="scroll"><mml:mi mathvariant="normal">Pr</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Pr</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>&#x02264;</mml:mi><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">Pr</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mi>&#x02264;</mml:mi><mml:mi>z</mml:mi><mml:mtext>,all</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mtext>,</mml:mtext></mml:math></disp-formula>where <italic>m</italic> is the number of ordinates at the positive frequencies of the periodogram.</p><p>Eqs. <xref rid="e0035 e0040 e0045" ref-type="disp-formula">(1)&#x02013;(3)</xref> assume that the variance <inline-formula><mml:math id="M10" altimg="si10.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is known a priori. However, in practice, it is typically unknown, and an estimate is used. The variance <inline-formula><mml:math id="M11" altimg="si11.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> can be estimated directly from the time sequence <italic>x</italic>[<italic>n</italic>] using the sample variance. But since <italic>x</italic>[<italic>n</italic>] might not be available, it is better to estimate <inline-formula><mml:math id="M12" altimg="si12.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> directly from <italic>P<sub>xx</sub></italic>[<italic>k</italic>]. The estimate of <inline-formula><mml:math id="M13" altimg="si13.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> according to Priestley <xref rid="b0050" ref-type="bibr">[10]</xref> can be evaluated by<disp-formula id="e0025"><mml:math id="M14" altimg="si14.gif" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math></disp-formula>The quantity <inline-formula><mml:math id="M15" altimg="si15.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is an unbiased estimate of <inline-formula><mml:math id="M16" altimg="si16.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, and we will use it in place of <inline-formula><mml:math id="M17" altimg="si17.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref rid="e0040" ref-type="disp-formula">(2)</xref> to define the sample ratio test statistic,<disp-formula id="e0050"><label>(4)</label><mml:math id="M18" altimg="si18.gif" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mi>&#x02264;</mml:mi><mml:mi>k</mml:mi><mml:mi>&#x02264;</mml:mi><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">xx</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac><mml:mtext>.</mml:mtext></mml:math></disp-formula>When <italic>m</italic> is large, <inline-formula><mml:math id="M19" altimg="si19.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> will be a good approximation to <inline-formula><mml:math id="M20" altimg="si20.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>; thus, we can treat the denominator of <xref rid="e0050" ref-type="disp-formula">(4)</xref> as <inline-formula><mml:math id="M21" altimg="si21.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Then, <inline-formula><mml:math id="M22" altimg="si22.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> will have the same distribution as <inline-formula><mml:math id="M23" altimg="si23.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, and asymptotically under <italic>H</italic><sub>0</sub> we have, for <italic>z</italic>&#x000a0;&#x02a7e;&#x000a0;0,<disp-formula id="e0055"><label>(5)</label><mml:math id="M24" altimg="si24.gif" overflow="scroll"><mml:mi mathvariant="normal">Pr</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#x0003e;</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>&#x0223c;</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi mathvariant="normal">exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>z</mml:mi><mml:mo>/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msup><mml:mtext>.</mml:mtext></mml:math></disp-formula>The asymptotic distribution of <inline-formula><mml:math id="M25" altimg="si25.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is the basis of Walker&#x02019;s large sample test for max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), <xref rid="b0050" ref-type="bibr">[10]</xref>.</p><p>Under the alternative hypothesis <italic>H</italic><sub>1</sub>, where the signal is periodic, the sample ratio test statistic <inline-formula><mml:math id="M26" altimg="si26.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> will be large. This enables us to use a one sided test and select the critical region <inline-formula><mml:math id="M27" altimg="si27.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="M28" altimg="si28.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is selected so the right hand side of <xref rid="e0055" ref-type="disp-formula">(5)</xref> is equal to <italic>&#x003b1;</italic>, which represents the false positive probability of the test. If the calculated value of <inline-formula><mml:math id="M29" altimg="si29.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from the sample data is less than <inline-formula><mml:math id="M30" altimg="si30.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we then accept <italic>H</italic><sub>0</sub>, and conclude that <inline-formula><mml:math id="M31" altimg="si31.gif" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> does not have any periodic component. If <inline-formula><mml:math id="M32" altimg="si32.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is larger than <inline-formula><mml:math id="M33" altimg="si33.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we then reject <italic>H</italic><sub>0</sub>, with a false positive probability of <italic>&#x003b1;</italic> and conclude that <inline-formula><mml:math id="M34" altimg="si34.gif" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> has a periodic component. The value of <italic>&#x003b1;</italic> is selected based on how small we would like the false positive probability to be.</p><p>We note that Fisher has derived an exact test for max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]) <xref rid="b0050 b0060 b0100" ref-type="bibr">[10,12,20]</xref>. However, we use Walker&#x02019;s test for the following reasons: first, Fisher&#x02019;s test involves using combinatorial coefficients, which are limited in their accuracy as the number of sample points gets large; hence we lose the exactness of the test. Second, even if the number of sample points is not large, evaluating <inline-formula><mml:math id="M35" altimg="si35.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the Fisher test to set the critical region to <italic>&#x003b1;</italic> is not straight forward. Instead, we need for each measured <inline-formula><mml:math id="M36" altimg="si36.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to evaluate the probability that it would be greater than this value, and then check if the probability is smaller than <italic>&#x003b1;</italic> or not. Third, usually, we are not short of network traffic to get a good estimate <inline-formula><mml:math id="M37" altimg="si37.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to use in the denominator of <xref rid="e0050" ref-type="disp-formula">(4)</xref>.</p><p>In Walker&#x02019;s test described above, when the peak of the periodogram, max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), is significant, we can only declare that the count-feature sequence has a periodic component at some frequency <italic>f</italic>. The question would be can we conclude that the count-feature sequence has a periodic component with the frequency where max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]) is located. Hartley has answered the question and showed that the probability that the sequence has a periodic component at some other frequency <italic>f</italic> is less than <italic>&#x003b1;</italic>, the probability of false positive, <xref rid="b0050" ref-type="bibr">[10]</xref>. Therefore, when the peak of the periodogram, max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), is significant, we can conclude that the count-feature sequence contains a periodic component with the frequency where max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]) is located.</p></sec></sec><sec id="s0035"><title>Experimental setup: Evaluation and analysis</title><p>We utilize SLINGbot <xref rid="b0105" ref-type="bibr">[21]</xref> (<bold>S</bold>ystem for <bold>L</bold>ive <bold>I</bold>nvestigation of <bold>N</bold>ext <bold>G</bold>eneration <bold>bot</bold>s) to generate examples of botnet C2 traffic. The traffic includes downloading bot software, connecting to bot C2 servers, and receiving botnet commands. SLINGbot uses a C2 feature space that consists of five separate dimensions for the functionality of botnets. The five dimensions are the following: topology, rallying mechanism, communication protocol, control mechanism, and command authentication mechanism. We use SLINGbot to set three variants of botnets, two TinyP2P<xref rid="fn2" ref-type="fn">2</xref> and one IRC, which we discuss further in this section.</p><sec id="s0040"><title>Periodic behavior in packet and address counts of botnet C2 traffic</title><p>We use SLINGbot to set five bots and one bot master in a mesh topology; the bots use TinyP2P as its protocol of communication on port number 11375. Each bot is pre-programmed to update its data every 3&#x000a0;s by contacting other bots. The experiment was run for approximately 20&#x000a0;s. Since we notice that the C2 traffic of each of these six bots is similar, we will only discuss the traffic of one of them. We use an aggregation interval of 100&#x000a0;ms to extract the packet and address count sequences from the bot&#x02019;s traffic.</p><p><xref rid="f0010" ref-type="fig">Fig. 2</xref>&#x02019;s top plots show the packet and address count sequences of the C2 communication traffic of a TinyP2P bot. The periodic behavior is apparent in both count sequences. At the start of each period, each bot contacts other bot to check whether there are any updates, and if so it downloads them; after that, it becomes silent until the next period starts. The bottom plots in the same figure show the modified periodograms of these count sequences after subtracting their means and normalizing them by their standard deviations.</p><p>In both plots, there is a single major peak at 313&#x000a0;m<italic>Hz</italic>. This peak corresponds to a period of 3.2&#x000a0;s, which agrees with the 3-second pre-programmed period of the bot. We also notice that the peak of the periodogram of the address count sequence has a higher value than the one of the packet count sequence. This is due to the number of distinct addresses in the traffic flow, which has fewer fluctuations when compared to the number of packets.</p><p>We select the false positive probability, <italic>&#x003b1;</italic>, to be equal to 0.1%. This value is selected since, in general, it is desired to have a low false positive rate, in particular, in network anomaly detection systems. We equate the right hand side of <xref rid="e0055" ref-type="disp-formula">(5)</xref> to <italic>&#x003b1;</italic>, to get a threshold, <italic>z</italic><sub>0.1%</sub>, of 23.5.<xref rid="fn3" ref-type="fn">3</xref> We test the significance of the peak, max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), of the two periodograms by evaluating the sample ratio test statistic <inline-formula><mml:math id="M38" altimg="si38.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref rid="e0050" ref-type="disp-formula">(4)</xref> for both periodograms. The ratio value is found to be 61.7 and 70.7 for the periodogram of the packet and address count sequences, respectively. Since the two values of <inline-formula><mml:math id="M39" altimg="si39.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are larger than <italic>z</italic><sub>0.1%</sub>, we reject the null hypothesis and conclude that both sequences contain a periodic component with a frequency of 313&#x000a0;m<italic>Hz</italic>.</p></sec><sec id="s0045"><title>The effect of duty cycle on periodic behavior</title><p>We use SLINGbot to set another TinyP2P botnet that consists of five bots and one bot master. Each of the five bots is pre-programmed to update its data with a different period; the periods that the bots use are 3, 4, 5, 6, and 7&#x000a0;s. The experiment was run for approximately 35&#x000a0;s. We use an aggregation interval of 100&#x000a0;ms to extract the packet count of each bot&#x02019;s traffic.</p><p><xref rid="f0015" ref-type="fig">Fig. 3</xref>&#x02019;s top plots show the packet count sequences of two TinyP2P bot C2 traffic traces. The periods of the traffic for the first bot (top-left) and the second bot (top-right) are 4 and 6&#x000a0;s, respectively. As can be seen, the periodic behavior is apparent in both plots. <xref rid="f0015" ref-type="fig">Fig. 3</xref>&#x02019;s bottom plots show the modified periodograms of the packet sequences after subtracting their means and normalizing them by their standard deviations. The periodogram of the first bot (bottom-left) consists of a large peak at 273&#x000a0;m<italic>Hz</italic>. This peak corresponds to a period of 3.7&#x000a0;s, which agrees with the 4-second pre-programmed period of the bot. The periodogram of the first bot also consists of smaller peaks at the multiples of the frequency. The smaller peaks are the harmonic components as discussed in Section &#x0201c;Methodology: Test network traffic for periodic behavior using periodograms&#x0201d;. The same observations apply to the periodogram of the second bot (bottom-right), except that the peak is located at 176&#x000a0;m<italic>Hz</italic>, which corresponds to a period of 5.7&#x000a0;s. Similar to what we get in the first TinyP2P botnets, this period agrees with the 6-second pre-programmed period of the bot. We test the significance of the peak, max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), of each of the two periodograms by evaluating the sample ratio test statistic <inline-formula><mml:math id="M40" altimg="si40.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in <xref rid="e0050" ref-type="disp-formula">(4)</xref> for each periodogram.</p><p>We select the false positive probability, <italic>&#x003b1;</italic>, to be equal to 0.1%. We equate the right hand side of <xref rid="e0055" ref-type="disp-formula">(5)</xref> to <italic>&#x003b1;</italic>, to get a threshold, <inline-formula><mml:math id="M41" altimg="si41.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, of 24.9.<xref rid="fn4" ref-type="fn">4</xref> We obtain the values of <inline-formula><mml:math id="M42" altimg="si42.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for each of the two periodograms to be 101.4 and 77.0; both are larger than <inline-formula><mml:math id="M43" altimg="si43.gif" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Therefore, we reject the null hypothesis and conclude that both sequences have a periodic component. We note that the two reported values of <inline-formula><mml:math id="M44" altimg="si44.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in the packet count sequences of the second TinyP2P botnet C2 traffic traces (101.4 and 77.0) are higher than the one reported for the packet count of the first TinyP2P botnet C2 traffic traces (61.7). This is because the second botnet was run for a longer time (35&#x000a0;s), while the other one was run for a shorter time (20&#x000a0;s). This results in having a larger number of periods, which increases the traffic&#x02019;s periodogram peak value.</p><sec id="s0050"><title>Duty cycle</title><p>For a periodic train of pulses, the <italic>duty cycle</italic> is the ratio of the pulse duration divided by the period&#x02019;s length. We note that the active time duration of the packet count sequences shown in <xref rid="f0015" ref-type="fig">Fig. 3</xref>&#x02019;s top plots is not affected by the period&#x02019;s length in the two bots. Since the first bot&#x02019;s period is smaller than the second bot&#x02019;s period, the first bot&#x02019;s traffic duty cycle is higher than the second bot&#x02019;s traffic duty cycle. This causes the periodogram of the first bot to have a value of <inline-formula><mml:math id="M45" altimg="si45.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (101.4) that is higher than the value of <inline-formula><mml:math id="M46" altimg="si46.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for the second bot (77.0) because the ratio of the periodogram&#x02019;s peak to the harmonic components is larger. This is due to the following fact, which is illustrated in <xref rid="f0020" ref-type="fig">Fig. 4</xref>. The periodogram of a train of rectangular pulses is a sampled squared sinc function. For trains of rectangular pulses with a larger duty cycle, the ratio between the main peak and the harmonic components at the Periodogram is also larger. Hence, for trains of rectangular pulses with larger duty cycle, the main peak is more significant. <xref rid="f0020" ref-type="fig">Fig. 4</xref>&#x02019;s top-left plot shows a periodic train of rectangular pulses with a period of 10&#x000a0;s and a duty cycle of 25%. The top-right plot shows a similar periodic train of rectangular pulses, but with a duty cycle of 50%. The bottom plots show the periodograms of these two periodic signals after subtracting their means and normalizing them by their standard deviations. It can be seen that the periodic signal that has the higher duty cycle has a higher ratio between the periodogram&#x02019;s main peak and the harmonic components.</p></sec></sec><sec id="s0055"><title>Periodic behavior in control plane traffic</title><p>We use SLINGbot to set 20 bots and one bot master in a star topology that uses IRC (Internet Relay Chat) as its protocol of communication on port number 6667. The bot master is pre-programmed to broadcast its updates to the 20 bots every 5&#x000a0;s. The experiment was run for approximately 40&#x000a0;s. Since we notice that the C2 traffic in each of these 21 bots is similar, we will only analyze the traffic of one of them.</p><p><xref rid="f0025" ref-type="fig">Fig. 5</xref>&#x02019;s top plots show the packet and address count sequences for the C2 communication traffic of an IRC bot. As in the TinyP2P botnets, the periodic behavior is apparent in both count sequences. The bottom plots in the same figure show the modified periodograms of these sequences after subtracting their means and normalizing them by their standard deviations. In both plots, there is a single major peak at 195&#x000a0;m<italic>Hz</italic>. This peak corresponds to a period of 5.1&#x000a0;s, which agrees with the 5-second pre-programmed period of the bot. As in the TinyP2P bot, the peak, max&#x000a0;(<italic>P<sub>xx</sub></italic>[<italic>k</italic>]), of the periodogram of the address count has a higher value than the one for the periodogram of the packet count.</p><p>The two values of <inline-formula><mml:math id="M47" altimg="si47.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for the packet and address count sequences of the IRC botnet C2 traffic are 40.8 and 46.2, respectively. These two values are larger than <italic>z</italic><sub>0.1%</sub>&#x000a0;=&#x000a0;24.9.<xref rid="fn5" ref-type="fn">5</xref> Thus, we can conclude that both sequences contain a periodic component with a frequency of 195&#x000a0;m<italic>Hz</italic>. However, the two values are not as large as the ones in the sequences of the TinyP2P botnet traffic. This makes it easier for the bot master to hide the periodic behavior of the C2 traffic by adding background traffic on the same port to bury its C2 traffic, which we address in Section &#x0201c;Experimental setup: Evaluation and analysis&#x0201d;. The low value of <inline-formula><mml:math id="M48" altimg="si48.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is attributed to the low duty cycle of the count sequence, which resulted in higher harmonics in the frequency domain when compared to the periodogram&#x02019;s peak.</p><sec id="s0060"><title>Control plane traffic</title><p>We study at the <italic>control plane traffic</italic> of the IRC bot C2 traffic. The plots in <xref rid="f0030" ref-type="fig">Fig. 6</xref> show the packet and address count sequences of the IRC bot C2 control plane traffic and their modified periodograms. The plots look very similar to the ones in <xref rid="f0025" ref-type="fig">Fig. 5</xref>, where the packet and address count sequences are extracted from the control and data planes traffic trace.</p><p>Although the control plane packets in the IRC bot traffic constitutes 47% of the total number of packets in the control and data planes traffic, their volume (in bytes) is only 2.3% of the total size of the control and data planes traffic packets. Monitoring this much smaller traffic reduces significantly the processing time and effort. The impact of only monitoring the control plane traffic is reducing on the value of <inline-formula><mml:math id="M49" altimg="si49.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> from 40.8 to 35.7 in the case of the packet count sequence and from 46.2 to 34.9. Both values are still clearly larger than <italic>z</italic><sub>0.1%</sub>&#x000a0;=&#x000a0;24.9.</p></sec></sec><sec id="s0065"><title>Periodic behavior in the presence of background traffic</title><p>A bot master can attempt to evade the detection of its botnet members by hiding the periodic behavior of the C2 traffic. This can be done in two ways; first, the bot master can carry the C2 communication channel session over a common port number used by other Internet applications (e.g., HTTP on port 80). This will decrease the percentage of C2 traffic&#x02019;s volume over this port; hence, its periodic behavior may not be noticeable. Alternatively, the bot master can program the traffic over a pre-determined randomized sequence of port numbers instead of having the C2 traffic between different bots over a single port number. Such evasion schemes might prevent the detection of the periodic behavior of a bot&#x02019;s C2 traffic by relying on monitoring the traffic of a host <italic>per transport port numbers</italic>.</p><p>In this section, we check whether we can continue to detect the periodic behavior of the C2 traffic of a <italic>given bot</italic> in the presence of background traffic. We use the packet traces collected by the Lawrence Berkeley National Laboratory/ International Computer Science Institute (LBNL/ICSI) Enterprise Tracing Project <xref rid="b0110 b0115" ref-type="bibr">[22,23]</xref> as our background traffic. The packet traces were collected from two internal network locations at LBNL. LBNL is a research institute in the USA with a medium-sized enterprise network. Only packet header information is released to the public.</p><p>We use the HTTP traffic from the LBNL/ICSI packet trace as our background traffic, <italic>y</italic>[<italic>n</italic>]. We then add it to the C2 traffic of a TinyP2P bot, <italic>x</italic>[<italic>n</italic>]. The total traffic becomes<disp-formula id="e0060"><mml:math id="M50" altimg="si50.gif" overflow="scroll"><mml:mi>z</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mtext>,</mml:mtext></mml:math></disp-formula></p><p>and the resulting ratio <inline-formula><mml:math id="M51" altimg="si51.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> becomes noisy.<xref rid="fn6" ref-type="fn">6</xref> We use the Signal-to-Noise Ratio (SNR) to quantify the level of background traffic added. The SNR is the ratio of the power of the count-feature sequence of the botnet C2 traffic after subtracting its mean to the power of the count-feature sequence of the background traffic after subtracting its mean. In other words, the SNR is the ratio of the variances of the two sequences. The following formula is used to evaluate the SNR in dB:<disp-formula id="e0030"><mml:math id="M52" altimg="si52.gif" overflow="scroll"><mml:mtext>SNR</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi mathvariant="normal">log</mml:mi><mml:mfrac><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x002c6;</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x002c6;</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi mathvariant="normal">log</mml:mi><mml:mfrac><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x002c6;</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mo>&#x02211;</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x002c6;</mml:mo></mml:mrow></mml:mover></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:math></disp-formula>where <italic>N</italic> is the number of sample points of <italic>x</italic>[<italic>n</italic>] and <italic>y</italic>[<italic>n</italic>].</p><p><xref rid="f0035" ref-type="fig">Fig. 7</xref>&#x02019;s plots show the packet (top) and address (bottom) count sequences for three HTTP traffic traces at port 80 in the LBNL/ICSI data set. The three traces were collected on October, 4, 2004. The IP addresses of the hosts that generated the traffic along with the start times (in PDT) of the traffic traces are as follows: HTTP 1 traffic: (131.243.86.124, 1:46:12&#x000a0;pm), HTTP 2 traffic: (131.243.125.239, 1:25:05), and HTTP 3 traffic (131.243.219.252, 2:53:02&#x000a0;pm). We note that the traffic of the three hosts get more bursty as we go to the right of the figure, specifically when we look at the packet count sequences. We add the traffic of each of these three hosts to the C2 traffic of the TinyP2P bot shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref> to observe the effect of this on the sample ratio test statistic <inline-formula><mml:math id="M53" altimg="si53.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p><p><xref rid="f0040" ref-type="fig">Fig. 8</xref>&#x02019;s plots show the packet and address count sequences for the TinyP2P bot C2 traffic after adding the HTTP 1 traffic trace to it. The periodic behavior is still apparent in both plots and the period is still found to be 3.2&#x000a0;s. The periodic behavior can also be noticed from the modified periodograms that are plotted in the bottom plots in the same figure after subtracting their means and normalizing them by their standard deviations, where a distinguished peak is still located at the frequency of the sequences at 313&#x000a0;m<italic>Hz</italic>. However, the two values of <inline-formula><mml:math id="M54" altimg="si54.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for the packet and address count sequences of the total traffic (botnet C2 and background traffic) are less than the ones we had for <inline-formula><mml:math id="M55" altimg="si55.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> in the absence of background traffic. In the case of the packet count, the value has decreased from 61.7 to 54.1, and in the case of the address count, it decreased from 70.7 to 57.7. Both values are still higher than <italic>z</italic><sub>0.1%</sub> (23.5), hence, the test declares both sequences to have a periodic component. The two values of <inline-formula><mml:math id="M56" altimg="si56.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> are still high because the background traffic had a low variance of, which resulted in a high SNR of 8.3&#x000a0;dB and 7.3&#x000a0;dB in the packet and address count sequences, respectively.</p><p>The case is different when we add either the HTTP 2 or HTTP 3 traffic traces to the TinyP2P bot C2 traffic as shown in <xref rid="f0045 f0050" ref-type="fig">Figs. 9 and 10</xref>. The periodic behavior is no longer apparent in the top plots of both the packet and address count sequences. This is due to the bursty nature of the HTTP 2 and HTTP 3 traffic traces that resulted in a low SNR. When adding HTTP 2 traffic, the SNR values are &#x02212;9.2&#x000a0;dB and &#x02212;1.3&#x000a0;dB for the packet count sequence and B the address count sequences, respectively. When adding HTTP 3 traffic, the SNR values are&#x02212;9.8&#x000a0;dB and &#x02212;1.3&#x000a0;dB for the packet count sequence and address count sequences, respectively. We make a note of the large difference in the SNR values between the packet and address count sequences. The very low SNR values in the packet count sequences cause the values of <inline-formula><mml:math id="M57" altimg="si57.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to reach 21.4 and 14.6 when we add the HTTP 2 traffic and HTTP 3 traffic, respectively. Both values are lower than <italic>z</italic><sub>0.1%</sub> (23.5), hence, the test declares that the packet count sequences do not have a periodic component.</p><p>Contrary to the SNR values in the packet count sequences, they are not that low in the address count sequences. They only cause the values of <inline-formula><mml:math id="M58" altimg="si58.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to reach 46.6 and 49.5 when we add the HTTP 2 traffic and HTTP 3 traffic, respectively. Both values are still significantly higher than <italic>z</italic><sub>0.1%</sub> (23.5), hence, the test declares that the address count sequences have a periodic component. The periodic behavior can also be seen from the modified periodograms that are plotted in the bottom-right plots in <xref rid="f0045 f0050" ref-type="fig">Figs. 9 and 10</xref> after subtracting their means and normalizing them by their standard deviations, where a distinguished peak is located at 313&#x000a0;m<italic>Hz</italic>. We explain the reason behind the different observations between the packet and address count sequences. This is because of the fact that the number of distinct addresses (i.e., hosts) that a given host communicates with during a given aggregation interval is much smaller than the number of packets it would send/receive from these hosts. This makes address count sequences more robust to evasion schemes than packet count sequences.</p><p>The previous plots show the effect of adding the traffic of a single HTTP connection to a bot&#x02019;s C2 traffic. To examine the effect of adding the traffic of multiple HTTP connections to a bot&#x02019;s traffic, we add all of the three HTTP traffic traces to the C2 traffic trace. The results are shown <xref rid="f0055" ref-type="fig">Fig. 11</xref>&#x02019;s plots. The result we find in the packet count sequences is similar to the one we get after adding either the HTTP 2 or HTTP 3 traffic traces individually; i.e., the traffic trace no longer exhibits periodic behavior due to the low SNR. In the case of the address count sequences, the SNR is &#x02212;4.3&#x000a0;dB, which is (in absolute value) half of the SNR value (&#x02212;1.3&#x000a0;dB) when either the HTTP 2 or HTTP 3 traffic traces were added. The SNR value of &#x02212;4.3&#x000a0;dB causes the value of <inline-formula><mml:math id="M59" altimg="si59.gif" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> to reach 35.8, which is still higher than <italic>z</italic><sub>0.1%</sub> (23.5); hence, the test declares that the sequence has a periodic component. The periodic behavior can be seen from the modified periodograms that are plotted in the bottom-right plot in <xref rid="f0055" ref-type="fig">Fig. 11</xref> after subtracting their means and normalizing them by their standard deviations, where a distinguished peak is located at 313&#x000a0;m<italic>Hz</italic>.</p><p>To summarize, the detection of periodic behavior in botnet C2 traffic in the presence of background traffic depends on the count-feature sequence we test. In the case of packet count sequences, the test detects the periodic behavior down to a certain SNR level; below that level, it fails to detect the periodic behavior. We note that the results of adding background traffic to packet count sequences are similar to the results of AsSadhan et. al <xref rid="b0030" ref-type="bibr">[6]</xref> when random noise traffic was injected. In the case of address count sequences, the test is much more robust to the background traffic and succeeds in detecting the periodic behavior. This is because of the fact that the number of distinct addresses (i.e., hosts) that a given host communicates with during a given aggregation interval is much smaller than the number of packets it would send/receive from these hosts. This illustrates that address count sequences are more robust to background traffic than packet count sequences.</p></sec><sec id="s0070"><title>Method&#x02019;s limitations</title><p>We address some of the limitations of basing the detection of botnet C2 communication traffic on the detection of its periodic behavior. The bot master can attempt to hide the periodic behavior of its bots by uniformly randomizing the period within a certain small range. This can be modeled by a random phase. The detectability of the periodic behavior here will depend on how large the random phase is and on the period&#x02019;s length and the duty cycle. In case the bot master uses a larger range, such that the signal is no longer periodic, it will succeed in evading our test. However, such evasion scheme will limit the effectiveness of the exchange of C2 channel traffic between different bots. This will result in not having C2 updates at pre-determined times, which might disturb the effectiveness of the attack carried out by the botnet. In addition, there are certain applications that have a periodic nature. The traffic of these applications can introduce false positives, however, they can be easily white listed once we are aware of them. Alternatively, the output traffic of the test can be tested further using a more complex method to determine whether the observed periodic behavior is due to botnet C2 traffic or not. We note that such complex method might not scale up if applied directly to the original traffic trace. Therefore, our method can serve as a scalable first stage.</p></sec></sec><sec sec-type="conclusions" id="s0075"><title>Conclusions</title><p>We propose a method that detects periodic behavior in network traffic. The method starts with the evaluation if the periodogram of the traffic sequence and then it locates its peak. After that, it uses Walker&#x02019;s large sample test to determine whether the periodogram&#x02019;s peak is significant when compared to the rest of the periodogram&#x02019;s ordinates or not. If it is determined to be significant, it declares the presence of a periodic component whose frequency is where the peak is located.</p><p>We use this method to detect botnet command and control (C2) channels traffic by detecting their periodic behavior. Periodic behavior arises in botnet C2 traffic since in many botnet variants bots are pre-programmed to check for and download updates every <italic>T</italic> seconds. We generate two variants of botnet C2 communication traffic using SLINGbot, TinyP2P and IRC. We apply Walker&#x02019;s large sample test to the C2 traffic and show that the traffic in both botnets exhibits periodic behavior in <xref rid="f0010 f0015" ref-type="fig">Figs. 2 and 3</xref> and <xref rid="f0025 f0030" ref-type="fig">5 and 6</xref>. The periodic behavior was also detected when analyzing the control plane traffic only. Since the volume of control plane traffic is much smaller, monitoring it will considerably reduce the processing time and effort.</p><p>We examine the effect of the duty cycle, length of observed traffic, and period length of the C2 traffic on the test performance. We show that the test&#x02019;s performance increases with the increase in the duty cycle and/or the length of the observed traffic, and decreases with the decrease in the period length. We study cases where the bot master attempts to evade the detection of the periodic behavior of C2 traffic by mixing it with HTTP background traffic. Our results show that, depending on the count-feature that is being tested, periodic behavior can still be detected. When testing the packet count sequence, periodic behavior is detected up to a certain packet volume level; above that level, periodic behavior is no longer detected. When testing the address count sequence, the test is much more robust and succeeds in detecting the periodic behavior. This is due to the fact that the number of hosts that a given host communicates with during a given aggregation interval is much smaller than the number of packets it sends/receives from these hosts.</p></sec><sec id="s0080"><title>Conflict of interest</title><p><italic>The authors have declared no conflict of interest</italic>.</p></sec></body><back><ref-list><title>References</title><ref id="b0005"><label>1</label><mixed-citation publication-type="other" id="h0005">Bot Roast II&#x02019; Nets 8 Individuals. FBI Press Release; 2007 November 29.</mixed-citation></ref><ref id="b0010"><label>2</label><mixed-citation publication-type="other" id="h0010">Over 1 Million Potential Victims of Botnet Cyber Crime. FBI Press Release; 2007 June 13.</mixed-citation></ref><ref id="b0015"><label>3</label><mixed-citation publication-type="other" id="h0015">Symantec 2013 Internet Security Threat Report, vol. 18. Symantec Corp; 2013 April.</mixed-citation></ref><ref id="b0020"><label>4</label><mixed-citation publication-type="other" id="h0020">Symantec Global Internet Security Threat Report, trends for July&#x02013;December 07, vol. XIII. Symantec Corp; 2008 April.</mixed-citation></ref><ref id="b0025"><label>5</label><mixed-citation publication-type="other" id="h0025">AsSadhan B, Moura JMF, Lapsley D, Jones C, Strayer WT, editors. Detecting botnets using command and control traffic. Proceedings of IEEE international symposium on Network Computing And Applications (NCA). Cambridge, MA, USA; 2009 Jul 9&#x02013;11.</mixed-citation></ref><ref id="b0030"><label>6</label><mixed-citation publication-type="other" id="h0030">AsSadhan B, Moura JMF, Lapsley D, editors. Periodic behavior in botnet command and control channels traffic. Proceedings of IEEE GLOBECOM. Honolulu, HI, USA; 2009 November 30&#x02013;December 4.</mixed-citation></ref><ref id="b0035"><label>7</label><mixed-citation publication-type="other" id="h0035">Gu G, Zhang J, Lee W, editors. BotSniffer: detecting botnet command and control channels in network traffic. Proceedings of the 15th annual Network and Distributed System Security Symposium (NDSS&#x02019;08). San Diego, CA, USA; 2008 February 10&#x02013;13.</mixed-citation></ref><ref id="b0040"><label>8</label><mixed-citation publication-type="other" id="h0040">AsSadhan B, Kim H, Moura JMF, Wang X, editors. Network traffic behavior analysis by decomposition into control and data planes. Proceedings of international workshop on Security in Systems and Networks (SSN) in conjunction with the IEEE International Parallel and Distributed Processing Symposium (IPDPS). Miami, FL, USA; 2008 April 18.</mixed-citation></ref><ref id="b0045"><label>9</label><element-citation publication-type="book" id="h0045"><person-group person-group-type="author"><name><surname>Oppenheim</surname><given-names>A.</given-names></name><name><surname>Schafer</surname><given-names>R.</given-names></name><name><surname>Buck</surname><given-names>J.</given-names></name></person-group><chapter-title>Discrete-time signal processing</chapter-title><year>1999</year><publisher-name>Prentice-Hall</publisher-name><publisher-loc>Upper Saddle River, New Jersey</publisher-loc></element-citation></ref><ref id="b0050"><label>10</label><element-citation publication-type="book" id="h0050"><person-group person-group-type="author"><name><surname>Priestley</surname><given-names>M.B.</given-names></name></person-group><chapter-title>Spectral analysis and time series</chapter-title><year>1981</year><publisher-name>Academic Press</publisher-name><publisher-loc>San Diego</publisher-loc></element-citation></ref><ref id="b0055"><label>11</label><mixed-citation publication-type="other" id="h0055">AsSadhan B, Kim H, Moura JMF, editors. Long-range dependence analysis of control and data planes network traffic. Proceedings of the Saudi International Innovation Conference (SIIC). Leeds, UK; 2008 June 9&#x02013;10.</mixed-citation></ref><ref id="b0060"><label>12</label><mixed-citation publication-type="other" id="h0060">Ahdesm&#x000e4;ki M, L&#x000e4;hdesm&#x000e4;ki H, Yli-Harja O, editors. Robust fisher&#x02019;s test for periodicity detection in noisy biological time series. Proceedings of IEEE international workshop on Genomic Signal Processing and Statistics (GENSIPS). Tuusula, Finland; 2007 June 10&#x02013;12.</mixed-citation></ref><ref id="b0065"><label>13</label><element-citation publication-type="journal" id="h0065"><person-group person-group-type="author"><name><surname>Thomson</surname><given-names>D.J.</given-names></name><name><surname>Lanzerotti</surname><given-names>L.</given-names></name><name><surname>Medford</surname><given-names>L.</given-names></name><name><surname>Maclennan</surname><given-names>C.</given-names></name><name><surname>Meloni</surname><given-names>A.</given-names></name><name><surname>Gregori</surname><given-names>G.</given-names></name></person-group><article-title>Study of tidal periodicities using a transatlantic telecommunications cable</article-title><source>Geophys Res Lett</source><volume>13</volume><issue>6</issue><year>1986</year><fpage>525</fpage><lpage>528</lpage></element-citation></ref><ref id="b0070"><label>14</label><mixed-citation publication-type="other" id="h0070">Partridge C, Cousins D, Jackson AW, Krishnan R, Saxena T, Strayer WT, editors. Using signal processing to analyze wireless data traffic. Proceedings of ACM Workshop on Wireless Security (WiSe). Atlanta, GA, USA; 2002 September 28.</mixed-citation></ref><ref id="b0075"><label>15</label><element-citation publication-type="journal" id="h0075"><person-group person-group-type="author"><name><surname>Welch</surname><given-names>P.D.</given-names></name></person-group><article-title>The use of the fast Fourier transform for estimation of spectra: a method based on time averaging over short, modified periodograms</article-title><source>IEEE Trans Audio Electroacoustics</source><volume>15</volume><issue>2</issue><year>1967</year><fpage>70</fpage><lpage>74</lpage></element-citation></ref><ref id="b0080"><label>16</label><element-citation publication-type="journal" id="h0080"><person-group person-group-type="author"><name><surname>So</surname><given-names>H.C.</given-names></name><name><surname>Chan</surname><given-names>Y.T.</given-names></name><name><surname>Ma</surname><given-names>Q.</given-names></name><name><surname>Ching</surname><given-names>P.C.</given-names></name></person-group><article-title>Comparison of various periodograms for sinusoid detection and frequency estimation</article-title><source>IEEE Trans Aerospace Electron Syst</source><volume>35</volume><issue>3</issue><year>1999</year><fpage>945</fpage><lpage>952</lpage></element-citation></ref><ref id="b0085"><label>17</label><element-citation publication-type="book" id="h0085"><person-group person-group-type="author"><name><surname>Fukunaga</surname><given-names>K.</given-names></name></person-group><chapter-title>Statistical pattern recognition</chapter-title><edition>2nd ed.</edition><year>1990</year><publisher-name>Academic Press</publisher-name><publisher-loc>San Diego</publisher-loc></element-citation></ref><ref id="b0090"><label>18</label><element-citation publication-type="book" id="h0090"><person-group person-group-type="author"><name><surname>Trees</surname><given-names>H.V.</given-names></name></person-group><chapter-title>Detection, estimation, and modulation theory. Part 1</chapter-title><year>1968</year><publisher-name>John Wiley &#x00026; Sons</publisher-name><publisher-loc>New York</publisher-loc></element-citation></ref><ref id="b0095"><label>19</label><element-citation publication-type="book" id="h0095"><person-group person-group-type="author"><name><surname>Leon-Garcia</surname><given-names>A.</given-names></name></person-group><chapter-title>Probability and random processes for electrical engineering</chapter-title><edition>2nd ed.</edition><year>1994</year><publisher-name>Addison Wesley</publisher-name><publisher-loc>Reading, Massachusetts</publisher-loc></element-citation></ref><ref id="b0100"><label>20</label><element-citation publication-type="book" id="h0100"><person-group person-group-type="author"><name><surname>Brockwell</surname><given-names>P.</given-names></name><name><surname>Davis</surname><given-names>R.</given-names></name></person-group><chapter-title>Time series: theory and methods</chapter-title><edition>2nd ed.</edition><year>1991</year><publisher-name>Springer-Verlag</publisher-name><publisher-loc>New York</publisher-loc></element-citation></ref><ref id="b0105"><label>21</label><mixed-citation publication-type="other" id="h0105">Jackson AW, Lapsley D, Jones C, Zatko M, Golubitsky C, Strayer WT, editors. SLINGbot: a system for live investigation of next generation botnets. Proceedings of Cybersecurity Application and Technologies Conference for Homeland Security (CATCH). Washington, DC; 2009 March 3&#x02013;4.</mixed-citation></ref><ref id="b0110"><label>22</label><mixed-citation publication-type="other" id="h0110">LBNL/ICSI Enterprise Tracing Project. &#x0003c;<ext-link ext-link-type="uri" xlink:href="http://www.icir.org/enterprise-tracing/" id="ir0005">http://www.icir.org/enterprise-tracing/</ext-link>&#x0003e; [accessed January 2013].</mixed-citation></ref><ref id="b0115"><label>23</label><mixed-citation publication-type="other" id="h0115">Pang R, Allman M, Bennett M, Lee J, Paxson V, Tierney B, editors. A first look at modern enterprise traffic. Proceedings of ACM SIGCOMM/USENIX internet measurement conference; Berkeley, CA, USA; 2005 October 19&#x02013;21.</mixed-citation></ref></ref-list><ack id="ak005"><title>Acknowledgments</title><p>Basil AsSadhan extends his appreciation to the Deanship of Scientific Research at King Saud University for funding this work through Research Project No. NFG2-02-33. We gratefully acknowledge the discussions of Dr. David Lapsley, Dr. W. Timothy Strayer, Dr. Alden Jackson, and Ms. Christine Jones and for giving us access to the SLINGbot to generate examples of botnet C2 traffic.</p></ack><fn-group><fn id="d32e135"><p>Peer review under responsibility of Cairo University.</p><p><fig id="f0060"><graphic xlink:href="fx1"/></fig></p></fn><fn id="fn1"><label>1</label><p>A binomial random variable is defined as the sum of <italic>n</italic> independent identically distributed (i.i.d.) Bernoulli random variables with probability <italic>p</italic>.</p></fn><fn id="fn2"><label>2</label><p>A TinyP2P botnet is a botnet that uses TinyP2P as its communication protocol <xref rid="b0105" ref-type="bibr">[21]</xref>.</p></fn><fn id="fn3"><label>3</label><p>The number of ordinates at the positive frequencies of both periodograms, <italic>m</italic>, used in evaluating, <italic>z</italic><sub>0.1%</sub> is 128.</p></fn><fn id="fn4"><label>4</label><p>The number of ordinates at the positive frequencies of both periodograms, <italic>m</italic>, used in evaluating, <italic>z</italic><sub>0.1%</sub> is 256.</p></fn><fn id="fn5"><label>5</label><p>The number of ordinates at the positive frequencies of both periodograms, <italic>m</italic>, used in evaluating , <italic>z</italic><sub>0.1%</sub> is 256.</p></fn><fn id="fn6"><label>6</label><p>We treat the background traffic here as noise traffic.</p></fn></fn-group></back><floats-group><fig id="f0005"><label>Fig. 1</label><caption><p>Left plots show a periodic train of rectangular pulses with a period of 0.1&#x000a0;s, and its one sided periodogram that consists of a large peak at the fundamental frequency and smaller peaks at the harmonics. Right plots show an aperiodic signal, and its one sided periodogram that consists of several small peaks.</p></caption><graphic xlink:href="gr1"/></fig><fig id="f0010"><label>Fig. 2</label><caption><p>Left plots show the packet count for the C2 communication traffic of TinyP2P bot and its one sided periodogram. Right plots show the address count for the same traffic and its one sided periodogram. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr2"/></fig><fig id="f0015"><label>Fig. 3</label><caption><p>The top plots show the packet count sequences for the C2 communication channels traffic of two TinyP2P bots with two different periods. The bottom plots show the one sided periodogram of each sequence. The aggregation interval for the packet count is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr3"/></fig><fig id="f0020"><label>Fig. 4</label><caption><p>Left plots show a periodic train of rectangular pulses with a period of 10&#x000a0;s and a duty cycle of 25%, and its one sided periodogram. Right plots show a periodic train of rectangular pulses with the same period and a duty cycle of 50%, and its one sided periodogram. The ratio between the periodogram&#x02019;s main peak and the harmonic components is higher in the periodic signal that has the higher duty cycle.</p></caption><graphic xlink:href="gr4"/></fig><fig id="f0025"><label>Fig. 5</label><caption><p>Left plots show the packet count for the C2 communication traffic of an IRC bot and its one sided periodogram. Right plots show the address count for the same traffic and its one sided periodogram. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr5"/></fig><fig id="f0030"><label>Fig. 6</label><caption><p>Left plots show the packet count for the control plane of the C2 communication traffic of an IRC bot and its one sided periodogram. Right plots show the address count for the same traffic and its one sided periodogram. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr6"/></fig><fig id="f0035"><label>Fig. 7</label><caption><p>The packet (top) and address (bottom) count sequences for three HTTP traffic traces in the LBNL/ICSI data set.</p></caption><graphic xlink:href="gr7"/></fig><fig id="f0040"><label>Fig. 8</label><caption><p>The packet and address count sequences with their one sided periodograms of the C2 communication traffic of the TinyP2P bot shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref> with the HTTP 1 traffic shown in <xref rid="f0035" ref-type="fig">Fig. 7</xref> added to it. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr8"/></fig><fig id="f0045"><label>Fig. 9</label><caption><p>The packet and address count sequences with their one sided periodograms of the C2 communication traffic of the TinyP2P bot shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref> with the HTTP 2 traffic shown in <xref rid="f0035" ref-type="fig">Fig. 7</xref> added to it. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr9"/></fig><fig id="f0050"><label>Fig. 10</label><caption><p>The packet and address count sequences with their one sided periodograms of the C2 communication traffic of the TinyP2P bot shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref> with the HTTP 3 traffic shown in <xref rid="f0035" ref-type="fig">Fig. 7</xref> added to it. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr10"/></fig><fig id="f0055"><label>Fig. 11</label><caption><p>The packet and address count sequences with their one sided periodograms of the C2 communication traffic of the TinyP2P bot shown in <xref rid="f0010" ref-type="fig">Fig. 2</xref> with all of the three HTTP traffic trace shown in <xref rid="f0035" ref-type="fig">Fig. 7</xref> added to it. The aggregation interval for the packet and address counts is 100&#x000a0;ms.</p></caption><graphic xlink:href="gr11"/></fig></floats-group></article>